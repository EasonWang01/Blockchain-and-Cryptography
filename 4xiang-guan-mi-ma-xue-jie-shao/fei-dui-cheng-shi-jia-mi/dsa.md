# DSA\(Digital Signature Algorithm\)

在1991年DSA 演算法被採納作為**Digital Signature Standard**\(**DSS\)**數位憑證標準之演算法。

#### 參數選擇

```
1. 選擇一個Hash function 當作H  (e.g.SHA系列)

2. 選擇 L 和 N 的長度   FIPS 186-3 選定了 L 和 N 長度對為 
(1,024, 160), (2,048, 224), (2,048, 256), (3,072, 256). N 必須小於等於 Hash function H 產生出來的長度.

3. 選擇一個 N-bit 的質數 q (N即為剛才選的數字)

4. 選擇 L-bit 的質數 p(L即為剛才選的數字)，並且 p − 1 是 q 的倍數
```

最後選擇一個g 這個 $$g^q $$ = 1 mod p

之後這三個參數\(p, g, q\)可以公開分享。

#### 公鑰與私鑰

```
在0 < x < q 條件下任一選擇一個適合長度的私鑰x
```

之後公鑰即為$$y = g^x$$ mod p

#### 簽名

```
1. 在1 < k < q 條件下隨機產生一個k
2. 計算r， r = ((g ** k) mod p) mod q，假設r算出來為0則換一個k再算一次
3. 計算s， s = ((k ** -1) * (H(m) + xr)) mod q，假設s算出來為0則換一個k再算一次
```

得到簽名為\(r, s\)

#### 驗證

```
1. 如果0 < r < q或是0 < s < q則拒絕
2. 計算w， w = (s ** -1) mod q
3. 計算u1，u1 = H(m) * w mod q
4. 計算u2，u2 = (r * w) mod q
```

最後計算 v

![](/assets/螢幕快照 2018-01-07 上午11.50.11.png)

如果算出之 v = r 則驗證成功。

